<?xml version="1.0" encoding="iso-8859-1"?>
<root>
	<windowclass name="rollselectorbutton">
		<margins control="0,0,0,10" />
		<script>
			function onInit()
				DB.addHandler(DB.getPath(getDatabaseNode(),"name"), "onUpdate", nameChanged);
				DB.addHandler(DB.getPath(getDatabaseNode(),"name_short"), "onUpdate", nameChanged);
				nameChanged()
			end

			function nameChanged()
				if name_short.getValue()~="" then
					display_name.setValue(name_short.getValue());
				else
					display_name.setValue(name.getValue());
				end
				bname.setText(display_name.getValue());
			end
		</script>
		<sheetdata>
			<button_text name="bname">
				<anchored position="insidetopleft" offset="5,5" height="20">
					<right offset="-5" />
				</anchored>
				<script>
					function onButtonPress()
						DB.setValue(window.windowlist.window.getDatabaseNode(),"selected", "string",window.name.getValue());
						if DB.getValue("requestsheet.clicktoroll", 0) == 1 then
							--parse the path then get the last element of the table to get the rollType
							local sPath = UtilityManager.parsePath(DB.getPath(window.windowlist.window.getDatabaseNode()))
							RRRollManager.onButtonPress(sPath[#sPath]);
						end
					end
				</script>
			</button_text>

			<hn name="show"/>
			<hs name="name"/>
			<hs name="name_short"/>
			<hs name="display_name"/>
		</sheetdata>
	</windowclass>	
</root>